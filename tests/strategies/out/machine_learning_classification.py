import pandas as pd
from pandas import Timestamp

expected_data = pd.DataFrame(
    [
        {
            "open_time": Timestamp("2023-09-01 14:45:00+0000", tz="UTC"),
            "close_time": Timestamp("2023-09-01 14:49:59.999000+0000", tz="UTC"),
            "open": 56168.82,
            "high": 56269.99,
            "low": 56080.96,
            "close": 56191.11,
            "volume": 324.51432,
            "quote_volume": 18225087.41727558,
            "trades": 8352,
            "taker_buy_asset_volume": 145.064381,
            "taker_buy_quote_volume": 8146012.47892439,
            "returns": 0.0003967606653441501,
            "returns_lag5": 0.0,
            "returns_lag4": 0.002946423556387118,
            "returns_lag3": 0.006818529518377586,
            "returns_lag2": 0.005926179097336494,
            "returns_lag1": -0.00170962942015996,
            "returns_sma_5_mean": 0.0028756526834570776,
        },
        {
            "open_time": Timestamp("2023-09-01 14:50:00+0000", tz="UTC"),
            "close_time": Timestamp("2023-09-01 14:54:59.999000+0000", tz="UTC"),
            "open": 56191.11,
            "high": 56200.0,
            "low": 56107.98,
            "close": 56145.0,
            "volume": 254.091606,
            "quote_volume": 14265787.89818125,
            "trades": 6455,
            "taker_buy_asset_volume": 134.1124,
            "taker_buy_quote_volume": 7529521.30623853,
            "returns": -0.0008209293091875578,
            "returns_lag5": 0.002946423556387118,
            "returns_lag4": 0.006818529518377586,
            "returns_lag3": 0.005926179097336494,
            "returns_lag2": -0.00170962942015996,
            "returns_lag1": 0.0003967606653441501,
            "returns_sma_5_mean": 0.0021221821103421423,
        },
        {
            "open_time": Timestamp("2023-09-01 14:55:00+0000", tz="UTC"),
            "close_time": Timestamp("2023-09-01 14:59:59.999000+0000", tz="UTC"),
            "open": 56145.0,
            "high": 56211.7,
            "low": 56106.97,
            "close": 56182.11,
            "volume": 270.145731,
            "quote_volume": 15171017.18758856,
            "trades": 7707,
            "taker_buy_asset_volume": 168.231118,
            "taker_buy_quote_volume": 9447425.0774598,
            "returns": 0.0006607487960858385,
            "returns_lag5": 0.006818529518377586,
            "returns_lag4": 0.005926179097336494,
            "returns_lag3": -0.00170962942015996,
            "returns_lag2": 0.0003967606653441501,
            "returns_lag1": -0.0008209293091875578,
            "returns_sma_5_mean": 0.000890625965883793,
        },
        {
            "open_time": Timestamp("2023-09-01 15:00:00+0000", tz="UTC"),
            "close_time": Timestamp("2023-09-01 15:04:59.999000+0000", tz="UTC"),
            "open": 56182.12,
            "high": 56299.78,
            "low": 56172.09,
            "close": 56289.89,
            "volume": 298.797415,
            "quote_volume": 16804824.55255641,
            "trades": 9000,
            "taker_buy_asset_volume": 139.83665,
            "taker_buy_quote_volume": 7864202.02549528,
            "returns": 0.0019165664875115606,
            "returns_lag5": 0.005926179097336494,
            "returns_lag4": -0.00170962942015996,
            "returns_lag3": 0.0003967606653441501,
            "returns_lag2": -0.0008209293091875578,
            "returns_lag1": 0.0006607487960858385,
            "returns_sma_5_mean": 8.870344391880628e-05,
        },
    ], index=[9, 10, 11, 12]
)

expected_data_set_parameters = pd.DataFrame(
    [
        {
            "open_time": Timestamp("2023-09-01 14:45:00+0000", tz="UTC"),
            "close_time": Timestamp("2023-09-01 14:49:59.999000+0000", tz="UTC"),
            "open": 56168.82,
            "high": 56269.99,
            "low": 56080.96,
            "close": 56191.11,
            "volume": 324.51432,
            "quote_volume": 18225087.41727558,
            "trades": 8352,
            "taker_buy_asset_volume": 145.064381,
            "taker_buy_quote_volume": 8146012.47892439,
            "returns": 0.0003967606653441501,
            "returns_lag5": 0.0,
            "volume_lag5": 276.690734,
            "returns_lag4": 0.002946423556387118,
            "volume_lag4": 149.363426,
            "returns_lag3": 0.006818529518377586,
            "volume_lag3": 692.924319,
            "returns_lag2": 0.005926179097336494,
            "volume_lag2": 603.660118,
            "returns_lag1": -0.00170962942015996,
            "volume_lag1": 370.500359,
            "returns_sma_5_mean": 0.0028756526834570776,
        },
        {
            "open_time": Timestamp("2023-09-01 14:50:00+0000", tz="UTC"),
            "close_time": Timestamp("2023-09-01 14:54:59.999000+0000", tz="UTC"),
            "open": 56191.11,
            "high": 56200.0,
            "low": 56107.98,
            "close": 56145.0,
            "volume": 254.091606,
            "quote_volume": 14265787.89818125,
            "trades": 6455,
            "taker_buy_asset_volume": 134.1124,
            "taker_buy_quote_volume": 7529521.30623853,
            "returns": -0.0008209293091875578,
            "returns_lag5": 0.002946423556387118,
            "volume_lag5": 149.363426,
            "returns_lag4": 0.006818529518377586,
            "volume_lag4": 692.924319,
            "returns_lag3": 0.005926179097336494,
            "volume_lag3": 603.660118,
            "returns_lag2": -0.00170962942015996,
            "volume_lag2": 370.500359,
            "returns_lag1": 0.0003967606653441501,
            "volume_lag1": 324.51432,
            "returns_sma_5_mean": 0.0021221821103421423,
        },
        {
            "open_time": Timestamp("2023-09-01 14:55:00+0000", tz="UTC"),
            "close_time": Timestamp("2023-09-01 14:59:59.999000+0000", tz="UTC"),
            "open": 56145.0,
            "high": 56211.7,
            "low": 56106.97,
            "close": 56182.11,
            "volume": 270.145731,
            "quote_volume": 15171017.18758856,
            "trades": 7707,
            "taker_buy_asset_volume": 168.231118,
            "taker_buy_quote_volume": 9447425.0774598,
            "returns": 0.0006607487960858385,
            "returns_lag5": 0.006818529518377586,
            "volume_lag5": 692.924319,
            "returns_lag4": 0.005926179097336494,
            "volume_lag4": 603.660118,
            "returns_lag3": -0.00170962942015996,
            "volume_lag3": 370.500359,
            "returns_lag2": 0.0003967606653441501,
            "volume_lag2": 324.51432,
            "returns_lag1": -0.0008209293091875578,
            "volume_lag1": 254.091606,
            "returns_sma_5_mean": 0.000890625965883793,
        },
        {
            "open_time": Timestamp("2023-09-01 15:00:00+0000", tz="UTC"),
            "close_time": Timestamp("2023-09-01 15:04:59.999000+0000", tz="UTC"),
            "open": 56182.12,
            "high": 56299.78,
            "low": 56172.09,
            "close": 56289.89,
            "volume": 298.797415,
            "quote_volume": 16804824.55255641,
            "trades": 9000,
            "taker_buy_asset_volume": 139.83665,
            "taker_buy_quote_volume": 7864202.02549528,
            "returns": 0.0019165664875115606,
            "returns_lag5": 0.005926179097336494,
            "volume_lag5": 603.660118,
            "returns_lag4": -0.00170962942015996,
            "volume_lag4": 370.500359,
            "returns_lag3": 0.0003967606653441501,
            "volume_lag3": 324.51432,
            "returns_lag2": -0.0008209293091875578,
            "volume_lag2": 254.091606,
            "returns_lag1": 0.0006607487960858385,
            "volume_lag1": 270.145731,
            "returns_sma_5_mean": 8.870344391880628e-05,
        },
    ],
    index=[9, 10, 11, 12]
)

expected_signal = 1
