from pandas import Timestamp

expected_performance = 0.997003
expected_outperformance = -0.005152

expected_optimization_results = (
    {"window_slow": 4.0, "window_fast": 3.0, "window_sign": 3.0},
    1.009722,
)

expected_results = {
    1: [
        {
            "close_time": Timestamp("2023-09-01 14:44:59.999000+0000", tz="UTC"),
            "open": 56260.11,
            "high": 56317.43,
            "low": 56118.31,
            "close": 56168.82,
            "volume": 370.500359,
            "quote_volume": 20822485.25288953,
            "trades": 1,
            "taker_buy_asset_volume": 178.075904,
            "taker_buy_quote_volume": 10007121.78892216,
            "returns": 0.0,
            "macd_diff": 37.90364648896147,
            "side": 1,
            "strategy_returns": 0.0,
            "strategy_returns_tc": 0.0,
            "equity": 1000.0,
            "accumulated_returns": 1.0,
            "accumulated_strategy_returns_tc": 1.0,
            "accumulated_strategy_returns": 1.0,
        },
        {
            "close_time": Timestamp("2023-09-01 14:49:59.999000+0000", tz="UTC"),
            "open": 56168.82,
            "high": 56269.99,
            "low": 56080.96,
            "close": 56191.11,
            "volume": 324.51432,
            "quote_volume": 18225087.41727558,
            "trades": 0,
            "taker_buy_asset_volume": 145.064381,
            "taker_buy_quote_volume": 8146012.47892439,
            "returns": 0.0003967606653441501,
            "macd_diff": 5.095611124768823,
            "side": 1,
            "strategy_returns": 0.0003967606653441501,
            "strategy_returns_tc": 0.0003967606653441501,
            "equity": 1000.3968393852675,
            "accumulated_returns": 1.0003968393852676,
            "accumulated_strategy_returns_tc": 1.0003968393852676,
            "accumulated_strategy_returns": 1.0003968393852676,
        },
        {
            "close_time": Timestamp("2023-09-01 14:54:59.999000+0000", tz="UTC"),
            "open": 56191.11,
            "high": 56200.0,
            "low": 56107.98,
            "close": 56145.0,
            "volume": 254.091606,
            "quote_volume": 14265787.89818125,
            "trades": 2,
            "taker_buy_asset_volume": 134.1124,
            "taker_buy_quote_volume": 7529521.30623853,
            "returns": -0.0008209293091875578,
            "macd_diff": -22.87327744557183,
            "side": -1,
            "strategy_returns": -0.0008209293091875578,
            "strategy_returns_tc": -0.0008209293091875578,
            "equity": 999.5759213029578,
            "accumulated_returns": 0.9995759213029578,
            "accumulated_strategy_returns_tc": 0.9995759213029578,
            "accumulated_strategy_returns": 0.9995759213029578,
        },
        {
            "close_time": Timestamp("2023-09-01 14:59:59.999000+0000", tz="UTC"),
            "open": 56145.0,
            "high": 56211.7,
            "low": 56106.97,
            "close": 56182.11,
            "volume": 270.145731,
            "quote_volume": 15171017.18758856,
            "trades": 0,
            "taker_buy_asset_volume": 168.231118,
            "taker_buy_quote_volume": 9447425.0774598,
            "returns": 0.0006607487960858385,
            "macd_diff": -28.20911405336851,
            "side": -1,
            "strategy_returns": -0.0006607487960858446,
            "strategy_returns_tc": -0.0006607487960858446,
            "equity": 998.9156708702212,
            "accumulated_returns": 1.0002366081395337,
            "accumulated_strategy_returns_tc": 0.9989156708702213,
            "accumulated_strategy_returns": 0.9989156708702213,
        },
        {
            "close_time": Timestamp("2023-09-01 15:04:59.999000+0000", tz="UTC"),
            "open": 56182.12,
            "high": 56299.78,
            "low": 56172.09,
            "close": 56289.89,
            "volume": 298.797415,
            "quote_volume": 16804824.55255641,
            "trades": 1,
            "taker_buy_asset_volume": 139.83665,
            "taker_buy_quote_volume": 7864202.02549528,
            "returns": 0.0019165664875115606,
            "macd_diff": -16.167489029180103,
            "side": 0,
            "strategy_returns": -0.0019165664875115203,
            "strategy_returns_tc": -0.0019165664875115203,
            "equity": 997.0030160221412,
            "accumulated_returns": 1.002155466324555,
            "accumulated_strategy_returns_tc": 0.9970030160221413,
            "accumulated_strategy_returns": 0.9970030160221413,
        },
    ]
    ,
    10: [
        {
            "close_time": Timestamp("2023-09-01 14:44:59.999000+0000", tz="UTC"),
            "open": 56260.11,
            "high": 56317.43,
            "low": 56118.31,
            "close": 56168.82,
            "volume": 370.500359,
            "quote_volume": 20822485.25288953,
            "trades": 1,
            "taker_buy_asset_volume": 178.075904,
            "taker_buy_quote_volume": 10007121.78892216,
            "returns": 0.0,
            "macd_diff": 37.90364648896147,
            "side": 1,
            "strategy_returns": 0.0,
            "strategy_returns_tc": 0.0,
            "margin_ratio": 0.0,
            "equity": 1000.0,
            "accumulated_returns": 1.0,
            "accumulated_strategy_returns_tc": 1.0,
            "accumulated_strategy_returns": 1.0,
        },
        {
            "close_time": Timestamp("2023-09-01 14:49:59.999000+0000", tz="UTC"),
            "open": 56168.82,
            "high": 56269.99,
            "low": 56080.96,
            "close": 56191.11,
            "volume": 324.51432,
            "quote_volume": 18225087.41727558,
            "trades": 0,
            "taker_buy_asset_volume": 145.064381,
            "taker_buy_quote_volume": 8146012.47892439,
            "returns": 0.0003967606653441501,
            "macd_diff": 5.095611124768823,
            "side": 1,
            "strategy_returns": 0.003960540547606178,
            "strategy_returns_tc": 0.003960540547606178,
            "margin_ratio": 0.04057206500534814,
            "equity": 1003.9683938526758,
            "accumulated_returns": 1.0003968393852676,
            "accumulated_strategy_returns_tc": 1.0039683938526758,
            "accumulated_strategy_returns": 1.0039683938526758,
        },
        {
            "close_time": Timestamp("2023-09-01 14:54:59.999000+0000", tz="UTC"),
            "open": 56191.11,
            "high": 56200.0,
            "low": 56107.98,
            "close": 56145.0,
            "volume": 254.091606,
            "quote_volume": 14265787.89818125,
            "trades": 2,
            "taker_buy_asset_volume": 134.1124,
            "taker_buy_quote_volume": 7529521.30623853,
            "returns": -0.0008209293091875578,
            "macd_diff": -22.87327744557183,
            "side": -1,
            "strategy_returns": -0.008210345158717942,
            "strategy_returns_tc": -0.008210345158717942,
            "margin_ratio": 0.04039420868308765,
            "equity": 995.7592130295782,
            "accumulated_returns": 0.9995759213029578,
            "accumulated_strategy_returns_tc": 0.9957592130295781,
            "accumulated_strategy_returns": 0.9957592130295781,
        },
        {
            "close_time": Timestamp("2023-09-01 14:59:59.999000+0000", tz="UTC"),
            "open": 56145.0,
            "high": 56211.7,
            "low": 56106.97,
            "close": 56182.11,
            "volume": 270.145731,
            "quote_volume": 15171017.18758856,
            "trades": 0,
            "taker_buy_asset_volume": 168.231118,
            "taker_buy_quote_volume": 9447425.0774598,
            "returns": 0.0006607487960858385,
            "macd_diff": -28.20911405336851,
            "side": -1,
            "strategy_returns": -0.006627217068784065,
            "strategy_returns_tc": -0.006627217068784065,
            "margin_ratio": 0.040529002487472494,
            "equity": 989.1819192263501,
            "accumulated_returns": 1.0002366081395337,
            "accumulated_strategy_returns_tc": 0.9891819192263501,
            "accumulated_strategy_returns": 0.9891819192263501,
        },
        {
            "close_time": Timestamp("2023-09-01 15:04:59.999000+0000", tz="UTC"),
            "open": 56182.12,
            "high": 56299.78,
            "low": 56172.09,
            "close": 56289.89,
            "volume": 298.797415,
            "quote_volume": 16804824.55255641,
            "trades": 1,
            "taker_buy_asset_volume": 139.83665,
            "taker_buy_quote_volume": 7864202.02549528,
            "returns": 0.0019165664875115606,
            "macd_diff": -16.167489029180103,
            "side": 0,
            "strategy_returns": -0.019449821191734596,
            "strategy_returns_tc": -0.019449821191734596,
            "margin_ratio": 0.0,
            "equity": 970.1284021724503,
            "accumulated_returns": 1.002155466324555,
            "accumulated_strategy_returns_tc": 0.9701284021724502,
            "accumulated_strategy_returns": 0.9701284021724502,
        },
    ],
    100: [
        {
            "close_time": Timestamp("2023-09-01 14:44:59.999000+0000", tz="UTC"),
            "open": 56260.11,
            "high": 56317.43,
            "low": 56118.31,
            "close": 56168.82,
            "volume": 370.500359,
            "quote_volume": 20822485.25288953,
            "trades": 1,
            "taker_buy_asset_volume": 178.075904,
            "taker_buy_quote_volume": 10007121.78892216,
            "returns": 0.0,
            "macd_diff": 37.90364648896147,
            "side": 1,
            "strategy_returns": 0.0,
            "strategy_returns_tc": 0.0,
            "margin_ratio": 0.0,
            "equity": 1000.0,
            "accumulated_returns": 1.0,
            "accumulated_strategy_returns_tc": 1.0,
            "accumulated_strategy_returns": 1.0,
        },
        {
            "close_time": Timestamp("2023-09-01 14:49:59.999000+0000", tz="UTC"),
            "open": 56168.82,
            "high": 56269.99,
            "low": 56080.96,
            "close": 56191.11,
            "volume": 324.51432,
            "quote_volume": 18225087.41727558,
            "trades": 0,
            "taker_buy_asset_volume": 145.064381,
            "taker_buy_quote_volume": 8146012.47892439,
            "returns": 0.0003967606653441501,
            "macd_diff": 5.095611124768823,
            "side": 1,
            "strategy_returns": 0.03891676170198583,
            "strategy_returns_tc": 0.03891676170198583,
            "margin_ratio": 0.5325145063126321,
            "equity": 1039.6839385267579,
            "accumulated_returns": 1.0003968393852676,
            "accumulated_strategy_returns_tc": 1.0396839385267578,
            "accumulated_strategy_returns": 1.0396839385267578,
        },
        {
            "close_time": Timestamp("2023-09-01 14:54:59.999000+0000", tz="UTC"),
            "open": 56191.11,
            "high": 56200.0,
            "low": 56107.98,
            "close": 56145.0,
            "volume": 254.091606,
            "quote_volume": 14265787.89818125,
            "trades": 2,
            "taker_buy_asset_volume": 134.1124,
            "taker_buy_quote_volume": 7529521.30623853,
            "returns": -0.0008209293091875578,
            "macd_diff": -22.87327744557183,
            "side": -1,
            "strategy_returns": -0.08225010462807437,
            "strategy_returns_tc": -0.08225010462807437,
            "margin_ratio": 0.504055899571967,
            "equity": 957.5921302957817,
            "accumulated_returns": 0.9995759213029578,
            "accumulated_strategy_returns_tc": 0.9575921302957816,
            "accumulated_strategy_returns": 0.9575921302957816,
        },
        {
            "close_time": Timestamp("2023-09-01 14:59:59.999000+0000", tz="UTC"),
            "open": 56145.0,
            "high": 56211.7,
            "low": 56106.97,
            "close": 56182.11,
            "volume": 270.145731,
            "quote_volume": 15171017.18758856,
            "trades": 0,
            "taker_buy_asset_volume": 168.231118,
            "taker_buy_quote_volume": 9447425.0774598,
            "returns": 0.0006607487960858385,
            "macd_diff": -28.20911405336851,
            "side": -1,
            "strategy_returns": -0.06833564640004638,
            "strategy_returns_tc": -0.06833564640004638,
            "margin_ratio": 0.5088282625334934,
            "equity": 894.3402446772526,
            "accumulated_returns": 1.0002366081395337,
            "accumulated_strategy_returns_tc": 0.8943402446772525,
            "accumulated_strategy_returns": 0.8943402446772525,
        },
        {
            "close_time": Timestamp("2023-09-01 15:04:59.999000+0000", tz="UTC"),
            "open": 56182.12,
            "high": 56299.78,
            "low": 56172.09,
            "close": 56289.89,
            "volume": 298.797415,
            "quote_volume": 16804824.55255641,
            "trades": 1,
            "taker_buy_asset_volume": 139.83665,
            "taker_buy_quote_volume": 7864202.02549528,
            "returns": 0.0019165664875115606,
            "macd_diff": -16.167489029180103,
            "side": 0,
            "strategy_returns": -0.22926166773797793,
            "strategy_returns_tc": -0.22926166773797793,
            "margin_ratio": 0.0,
            "equity": 711.1082168282761,
            "accumulated_returns": 1.002155466324555,
            "accumulated_strategy_returns_tc": 0.7111082168282761,
            "accumulated_strategy_returns": 0.7111082168282761,
        },
    ]
}
