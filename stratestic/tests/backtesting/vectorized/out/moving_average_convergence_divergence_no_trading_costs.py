import numpy as np
from pandas import Timestamp

expected_performance = 0.997003
expected_outperformance = -0.005152

expected_optimization_results = (np.array([4.0, 3.0, 3.0]), 1.009722)

expected_results = [
    {
        "close_time": Timestamp("2021-04-21 14:44:59.999000+0000", tz="UTC"),
        "open": 56260.11,
        "high": 56317.43,
        "low": 56118.31,
        "close": 56168.82,
        "volume": 370.500359,
        "quote_volume": 20822485.25288953,
        "trades": 1.0,
        "taker_buy_asset_volume": 178.075904,
        "taker_buy_quote_volume": 10007121.78892216,
        "returns": 0,
        "macd_diff": 37.90364648896147,
        "position": 1,
        "strategy_returns": 0.0,
        "strategy_returns_tc": 0.0,
        "accumulated_returns": 0.9982918311637462,
        "accumulated_strategy_returns": 1.0,
        "accumulated_strategy_returns_tc": 1.0,
    },
    {
        "close_time": Timestamp("2021-04-21 14:49:59.999000+0000", tz="UTC"),
        "open": 56168.82,
        "high": 56269.99,
        "low": 56080.96,
        "close": 56191.11,
        "volume": 324.51432,
        "quote_volume": 18225087.41727558,
        "trades": 0.0,
        "taker_buy_asset_volume": 145.064381,
        "taker_buy_quote_volume": 8146012.47892439,
        "returns": 0.0003967606653441501,
        "macd_diff": 5.095611124768823,
        "position": 1,
        "strategy_returns": 0.0003967606653441501,
        "strategy_returns_tc": 0.0003967606653441501,
        "accumulated_returns": 0.9986879926803429,
        "accumulated_strategy_returns": 1.0003968393852676,
        "accumulated_strategy_returns_tc": 1.0003968393852676,
    },
    {
        "close_time": Timestamp("2021-04-21 14:54:59.999000+0000", tz="UTC"),
        "open": 56191.11,
        "high": 56200.0,
        "low": 56107.98,
        "close": 56145.0,
        "volume": 254.091606,
        "quote_volume": 14265787.89818125,
        "trades": 2.0,
        "taker_buy_asset_volume": 134.1124,
        "taker_buy_quote_volume": 7529521.30623853,
        "returns": -0.0008209293091875578,
        "macd_diff": -22.87327744557183,
        "position": -1,
        "strategy_returns": -0.0008209293091875578,
        "strategy_returns_tc": -0.0008209293091875578,
        "accumulated_returns": 0.9978684768647185,
        "accumulated_strategy_returns": 0.9995759213029578,
        "accumulated_strategy_returns_tc": 0.9995759213029578,
    },
    {
        "close_time": Timestamp("2021-04-21 14:59:59.999000+0000", tz="UTC"),
        "open": 56145.0,
        "high": 56211.7,
        "low": 56106.97,
        "close": 56182.11,
        "volume": 270.145731,
        "quote_volume": 15171017.18758856,
        "trades": 0.0,
        "taker_buy_asset_volume": 168.231118,
        "taker_buy_quote_volume": 9447425.0774598,
        "returns": 0.0006607487960858385,
        "macd_diff": -28.20911405336851,
        "position": -1,
        "strategy_returns": -0.0006607487960858385,
        "strategy_returns_tc": -0.0006607487960858385,
        "accumulated_returns": 0.9985280351366296,
        "accumulated_strategy_returns": 0.9989156708702213,
        "accumulated_strategy_returns_tc": 0.9989156708702213,
    },
    {
        "close_time": Timestamp("2021-04-21 15:04:59.999000+0000", tz="UTC"),
        "open": 56182.12,
        "high": 56299.78,
        "low": 56172.09,
        "close": 56289.89,
        "volume": 298.797415,
        "quote_volume": 16804824.55255641,
        "trades": 1.0,
        "taker_buy_asset_volume": 139.83665,
        "taker_buy_quote_volume": 7864202.02549528,
        "returns": 0.0019165664875115606,
        "macd_diff": -16.167489029180103,
        "position": 0,
        "strategy_returns": -0.0019165664875115606,
        "strategy_returns_tc": -0.0019165664875115606,
        "accumulated_returns": 1.0004436155878982,
        "accumulated_strategy_returns": 0.9970030160221413,
        "accumulated_strategy_returns_tc": 0.9970030160221413,
    },
]
